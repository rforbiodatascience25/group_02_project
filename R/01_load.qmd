---
title: "01_load"
format: html
---

### Libraries

```{r}
library("here")
<<<<<<< HEAD
library('dplyr')
=======
library("tidyverse")
>>>>>>> a050a78f7b1cfea641cd6e8242bd455050372fcd
```

### Download data

```{r}
curl::curl_download(url = "https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE41080&format=file", 
                    destfile = here("data","_raw","GSE41080_RAW.tar"))
```

### Expression

```{r}
untar(here("data","_raw","GSE41080_RAW.tar"), 
      exdir = here("data","expression"))
```

```{r}
expression_files <- list.files(here("data","expression"))
```

```{r}
data_expression <- read_delim(here("data","expression",
                                   expression_files[2:92]), 
                              id = "file", 
                              col_names = c("PROBE_ID",
                                            "NBEADS1",
                                            "Signal",
                                            "Pval",
                                            "NARRAYS",
                                            "ARRAY_STDEV",
                                            "BEAD_STDERR",
                                            "NBEADS2",
                                            "SEARCH_KEY"), 
                              skip = 1,
                              na = "NaN")
data_expression <- mutate(data_expression, file = str_extract(file, "GSM[0-9]+"))
```

### Meta data

```{r}
metadata <- read_csv("../data/_raw/msb201315-s2.csv", n_max= 89)
```
